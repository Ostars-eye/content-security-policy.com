<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Content Security Policy Browser Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Content Security Policy Browser Test">
    <meta name="author" content="Foundeo Inc.">
	  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" integrity="sha256-M4BawzpX2gZqpVcQ1m+1u+phtpgCuUP8wgn+fDlFPR8=" crossorigin="anonymous" />
	  <link href="../css/style.css" rel="stylesheet" />
    <script src="../js/browser-test.js"></script>
  </head>

  <body onload="runUnsafeHashNode()">

    <div class="container">

      <div class="masthead">
      	
        <ul class="nav nav-pills pull-right">
          <li><a href="/">CSP Reference</a></li>
          <li><a href="/faq/" title="CSP FAQ">FAQ</a></li>
          <li class="active"><a href="/browser-test/" title="CSP Browser Test">Browser Test</a></li>
          <li><a href="/examples/" title="CSP Examples">Examples</a></li>
        </ul>
        <h3 class="muted">CSP Browser Test</h3>
      </div>

      <hr>

      <div class="jumbotron">
        <h1>Content Security Policy Browser Test</h1>
		    <div id="userAgent"></div>
      </div>

      <h2>JavaScript CSP Browser Test <small><span class="label label-primary">CSP Level 1</span></small></h2>
      <p>Note this test requires that you have JavaScript Enabled</p>

      <div class="alert alert-success" id="jsNode"><h3><i class="fa fa-check" aria-hidden="true"></i> CSP Supported</h3> If you can read this, then the inline JavaScript below this line did not execute.</div>
      <script>
        //if CSP is supported this will not run
        window.onload=function(){
            var jsNode = document.getElementById("jsNode");
            jsNode.innerHTML = "<h3> CSP Not Supported</h3> Your browser does not support CSP, the inline script executed and replaced this div content";
            jsNode.className = "alert alert-danger";
        };
      </script>
      <pre>
&lt;script&gt;
  //if CSP is supported this will not run
  window.onload=function(){
      var jsNode = document.getElementById("jsNode");
      jsNode.innerHTML = "&lt;h3&gt; CSP Not Supported&lt;/h3&gt; Your browser does not support CSP, the inline script executed and replaced this div content";
      jsNode.className = "alert alert-danger";
  };
&lt;/script&gt;
      </pre>

      <h2>Image CSP Browser Test <small><span class="label label-primary">CSP Level 1</span></small></h2>
      <p>This test attempts to load an image: https://unsplash.it/200/200 </p>
      <pre>&lt;img src="https://unsplash.it/200/200" alt="CSP Should Block This Image From Loading" id="cspImg"&gt;</pre>
      <div class="well" id="browserTestWell">
        <img src="https://unsplash.it/200/200" alt="CSP Should Block This Image From Loading" id="cspImg">
      </div>
      
      <p>If you see a gray box above then the image loading failed (presumably due to CSP, but it could also fail for other reasons such as the server being down).</p>
      
      <h2>JavaScript Hash Test <small><span class="label label-primary">CSP Level 2</span></small></h2>
      <p>CSP Level 2 does allow execution of inline scripts if a <a href="/hash">Hash</a> is present in the <code>script-src</code> directive.</p>
      <div class="alert alert-danger" id="hashNode"><h3>CSP Level 2 Inline Hash Not Supported</h3></div>
      <!-- the following will be allowed to run via hash
        sha256-ewTm8QMx/IkmbIFAIapvCHoCrGgIIHhn8qKC7/5Y2Ro=
        in the Content-Security-Policy
      -->
      <script>runHashTest();</script>


      <h2>JavaScript Unsafe Hashes Test <small><span class="label label-primary">CSP Level 3</span></small></h2>
      <p><a href="/unsafe-hashes/">CSP Level 3 unsafe-hashes</a> within <code>script-src</code> directive.</p>
      <div class="alert alert-danger" id="unsafeHashNode"><h3>CSP Level 3 Inline Hash Not Supported</h3></div>

	 
		<div class="footer">
        <p><a href="https://foundeo.com/">&copy; Foundeo Inc.</a> 2012-2021 - <a href="https://foundeo.com/contact/" rel="nofollow">Contact Us</a></p>
      </div>

    </div> <!-- /container -->
	
  
	   <script src="../js/google-analytics.js"></script>
	   
  </body>
</html>
